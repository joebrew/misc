###
# ATTACH LIBRARIES
###
library(sas7bdat)
library(rgdal)
library(RColorBrewer)
library(gstat)
library(geoR)
###
# SETWD CONDITIONAL TO SYSTEM I'M ON
###
if ( Sys.info()["sysname"] == "Linux" ){
setwd("/home/joebrew/Documents/")
} else {
setwd("C:/Users/BrewJR/Documents/")
}
###
# READ IN BRFSS DATA
###
dat <- read.sas7bdat("fdoh_private/brfss/alachua.sas7bdat")
names(dat)
names(dat[which(grepl("HRQ", names(dat)))])
source('~/.active-rstudio-document', echo=TRUE)
table(bu$school)
library(foreign)
library(XLConnect)
library(RODBC)
install.packages("gdata")
library(gdata)
fileList <- list.files(path=getwd(),
pattern=".\\.xlsx", full.name=FALSE, recursive= TRUE, ignore.case= TRUE)
fileList
getwd()
#Set Data Folder
if ( Sys.info()["sysname"] == "Linux" ){
setwd("/home/joebrew/Documents/misc/jane_ritho") } else {
setwd("C:\\Users\\jnr5443\\Committent_meds")
}
fileList <- list.files(path=getwd(),
pattern=".\\.xlsx", full.name=FALSE, recursive= TRUE, ignore.case= TRUE)
z <- length(fileList)
z
fileList
print(z)
x <- read.xls(fileList[1])
head(x)
?assign
for (i in 1:z) {
assign(paste0("file",i),
read.xls(fileList[i], skip = 1))
}
file1
View(file1)
for (i in 1:z) {
assign(paste0("file",i),
read.xls(fileList[i], skip = 5))
}
View(file1)
ls()
is.data.frame(ls())
temp = list.files(pattern="*.xlsx")
temp = list.files(pattern="*.xlsx")
myfiles = lapply(temp, read.xls, skip=5)
# RBIND ALL ELEMENTS OF THE MYFILES LIST INTO ONE DF
############
library(plyr)
raw.dat <- rbind.fill(myfiles)
head(raw.dat)
